unit_tests:
  - name: test_sale_model_when_full_refresh
    model: sale
    overrides:
      macros:
        # unit test this model in "full refresh" mode
        is_incremental: false 
    given:
      - input: source("source", "s_sale")
        rows:
          - {id: 1, vending_machine_id: 1, item_id: 1, saled_at: 2025-01-01}
          - {id: 2, vending_machine_id: 1, item_id: 1, saled_at: 2025-01-02}
      - input: this 
        # contents of current my_incremental_model
        rows:
          - {id: 1, vending_machine_id: 1, item_id: 1, saled_at: '2025-01-01'}
    expect:
      rows:
        - {id: 1, vending_machine_id: 1, item_id: 1, saled_at: 2025-01-01}
        - {id: 2, vending_machine_id: 1, item_id: 1, saled_at: 2025-01-02}

  - name: test_sale_model_when_incremental
    model: sale
    overrides:
      macros:
        is_incremental: true
    given:
      - input: source("source", "s_sale")
        rows:
          - {id: 1, vending_machine_id: 1, item_id: 1, saled_at: '2025-01-01'}
          - {id: 2, vending_machine_id: 1, item_id: 1, saled_at: '2025-01-02'}
      - input: this 
        # contents of current my_incremental_model
        rows:
          - {id: 1, vending_machine_id: 1, item_id: 1, saled_at: '2025-01-01'}
    expect:
      # what will be inserted/merged into my_incremental_model
      rows: 
        - {id: 2, vending_machine_id: 1, item_id: 1, saled_at: '2025-01-02'}
